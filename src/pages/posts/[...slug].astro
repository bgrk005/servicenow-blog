---
import Layout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("posts");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
const formattedDate = new Date(post.data.pubDate).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<Layout title={post.data.title} description={post.data.description}>
  <article class="prose max-w-3xl mx-auto mt-8 mb-16 dark:prose-invert">
    <header class="not-prose mb-8 border-b border-neutral-light pb-6 dark:border-neutral-dark">
      <p class="text-sm uppercase tracking-wide text-primary dark:text-primary-dark">
        {post.data.category ?? 'ServiceNow'}
      </p>
      <h1 class="mt-2 text-3xl font-bold text-neutral dark:text-neutral-light">{post.data.title}</h1>
      <p class="mt-3 text-base text-neutral dark:text-neutral-light/80">{post.data.description}</p>
      <p class="mt-3 text-sm text-neutral/70 dark:text-neutral-light/70">Published {formattedDate}</p>
      {Array.isArray(post.data.tags) && post.data.tags.length > 0 && (
        <div class="mt-4 flex flex-wrap gap-2">
          {post.data.tags.map((tag) => (
            <a href={`/tag/${tag.toLowerCase()}/`} class="text-xs bg-primary/20 text-primary dark:bg-primary-dark/20 dark:text-primary-dark py-1 px-2 rounded-full">
              {tag}
            </a>
          ))}
        </div>
      )}
    </header>
    <Content />
  </article>
</Layout>
